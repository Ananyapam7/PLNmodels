<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Analyze of the Trichopetra data set with the multivariate Poisson log-normal model â€¢ PLNmodels</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Analyze of the Trichopetra data set with the multivariate Poisson log-normal model">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PLNmodels</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.5.9001</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/index.html">Articles and Vignettes</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jchiquet/PLNmodels">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Analyze of the Trichopetra data set with the multivariate Poisson log-normal model</h1>
                        <h4 class="author">Julien Chiquet</h4>
            
            <h4 class="date">2018-11-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jchiquet/PLNmodels/blob/master/vignettes/PLN_trichoptera.Rmd"><code>vignettes/PLN_trichoptera.Rmd</code></a></small>
      <div class="hidden name"><code>PLN_trichoptera.Rmd</code></div>

    </div>

    
    
<p>This vignette illustrates the use of the <code>PLN</code> function and the methods accompaning the R6 class <code>PLNfit</code>. From the statistical point of view, the function <code>PLN</code> adjusts a multivariate Poisson lognormal model to a table of counts. Such data are common in many application fields such as ecology (abundance table), or genomics (single cell data). These data often comes with some external knowledge (via covariates and offsets) which should be taken into account during the fits.</p>
<p><code>PLN</code> is the building block for all the multivariate models found in the <code>PLNmodels</code> package: having a basic understanding of both the mathematical background and the associated set of <code>R</code> functions is good place to start.</p>
<p>We will illustrate our point with an ecological data set concerning abundances of Trichopetera species, coupled with some meteological factors that may influence the presence their presence.</p>
<div id="mathematical-background" class="section level2">
<h2 class="hasAnchor">
<a href="#mathematical-background" class="anchor"></a>Mathematical background</h2>
<p>The multivariate Poisson lognormal model relates some <span class="math inline">\(p\)</span>-dimensional observation vectors <span class="math inline">\(\mathbf{Y}_i\)</span> to some <span class="math inline">\(p\)</span>-dimensional vectors of Gaussian latent variables <span class="math inline">\(\mathbf{Z}_i\)</span> as follows <span class="math display">\[\begin{equation}
  \label{eq:pln-model}
  \begin{array}{rcl}
  \text{latent space } &amp;   \mathbf{Z}_i \sim \mathcal{N}({\boldsymbol\mu},\boldsymbol\Sigma) \\
  \text{observation space } &amp;  Y_{ij} | Z_{ij} \quad \text{indep.} &amp;   \mathbf{Y}_i | \mathbf{Z}_i\sim\mathcal{P}\left(\exp\{\mathbf{Z}_i\}\right)
  \end{array}
\end{equation}\]</span></p>
<p>The parameter <span class="math inline">\({\boldsymbol\mu}\)</span> corresponds to the main effects and the latent covariance matrix <span class="math inline">\(\boldsymbol\Sigma\)</span> describes the underlying structure of dependence between the <span class="math inline">\(p\)</span> variables.</p>
<p>This model generalizes naturally to a formulation closer to a multivariate generalize linear model, where the main effect is due to a linear combination of <span class="math inline">\(d\)</span> covariates <span class="math inline">\(\mathbf{x}_i\)</span>. We also let the possibility to add some offsets for the <span class="math inline">\(d\)</span> variables and in each sample., that is <span class="math inline">\(\mathbf{o}_i\)</span>. Hence, model  generalizes to</p>
<p><span class="math display">\[\begin{equation}
  \label{eq:pln-model-glm}
  \mathbf{Y}_i | \mathbf{Z}_i \sim \mathcal{P}\left(\exp\{\mathbf{Z}_i\}\right), \qquad \mathbf{Z}_i \sim \mathcal{N}({\mathbf{o}_i + \mathbf{x}_i^\top\boldsymbol\Theta},\boldsymbol\Sigma) \\
\end{equation}\]</span> where <span class="math inline">\(\boldsymbol\Theta\)</span> is a <span class="math inline">\(d\times p\)</span> matrix of regression parameters. At the end of the day, the data matrices available to feed the model are</p>
<ul>
<li>the <span class="math inline">\(n\times p\)</span> matrix of counts <span class="math inline">\(\mathbf{Y}\)</span>
</li>
<li>the <span class="math inline">\(n\times p\)</span> matrix of covariates <span class="math inline">\(\mathbf{X}\)</span>
</li>
<li>the <span class="math inline">\(n\times p\)</span> matrix of offsets <span class="math inline">\(\mathbf{O}\)</span>
</li>
</ul>
</div>
<div id="analysis-of-the-trichoptera-data-set" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-of-the-trichoptera-data-set" class="anchor"></a>Analysis of the Trichoptera data set</h2>
<div id="trichoptera-data" class="section level3">
<h3 class="hasAnchor">
<a href="#trichoptera-data" class="anchor"></a>Trichoptera data</h3>
<p>The trichoptera data set is included in the package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(PLNmodels)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/data">data</a></span>(trichoptera)</a></code></pre></div>
<p>See <code><a href="../reference/trichoptera.html">?PLNmodels::trichoptera</a></code> for details.</p>
<p>The <code>data.frame</code> <code>trichoptera</code> includes 49 rows (the observations - or trapping nights) and 14 columns.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(trichoptera)</a></code></pre></div>
<pre><code>##  [1] "Abundance"           "T_max"               "T_evening"          
##  [4] "T_min"               "Wind"                "Pressure"           
##  [7] "Pressure_range"      "Humidity"            "Cloudiness_night"   
## [10] "Precipitation_night" "Cloudiness_average"  "Precipitation_total"
## [13] "Group"</code></pre>
<p>The columns are all univariate covariates expect the <code>Abundance</code> column, which is a <span class="math inline">\(49 \times 17\)</span> matrix of abundancies for each 17 species during the 49 trapping nights. It corresponds to the matrix <span class="math inline">\(\mathbf{Y}\)</span> in our model:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">trichoptera<span class="op">$</span>Abundance[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, ]</a></code></pre></div>
<pre><code>##   Che Hyc Hym Hys Psy Aga Glo Ath Cea Ced Set All Han Hfo Hsp Hve Sta
## 1   0   0   5   0  17   0   0   0   0   2   0   1   0   1   2   0   1
## 2   0   0   3   0   8   0   0   0   0   0   0   2   0   0   0   0   0
## 3   0   0   1   0  32   0   0   0   0   0   0   4   0   0   1   0   0
## 4   0   0   3   0 176   4   0   0   0   1   0   3   0   0   3   0   2
## 5   0   0   4   0  69   2   0   0   0   0   0   1   0   0   1   0   2</code></pre>
<p>The matrix <span class="math inline">\(49 \times 13\)</span> entries remaings corresponds to the matrix <span class="math inline">\(\mathbf{X}\)</span> in our model:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(trichoptera[, <span class="dv">-1</span>])</a></code></pre></div>
<pre><code>##   T_max T_evening T_min Wind Pressure Pressure_range Humidity
## 1  22.2      18.7  11.0 -2.3    998.5            4.1       60
## 2  24.2      19.8   8.4 -2.7    999.5           -1.1       63
## 3  27.4      22.0  11.0 -0.7    997.2           -3.6       73
## 4  29.0      23.0  12.6  2.3    991.1           -6.2       71
## 5  28.2      22.5  12.0  2.3    990.1            1.7       62
## 6  28.0      23.9  13.8 -2.0    990.1           -0.8       64
##   Cloudiness_night Precipitation_night Cloudiness_average
## 1               19                   0                 17
## 2                0                   0                 27
## 3                6                   0                 13
## 4               81                   0                 52
## 5               50                   0                 34
## 6               50                   0                 36
##   Precipitation_total Group
## 1                   0     1
## 2                   0     1
## 3                   0     1
## 4                   0     1
## 5                   0     1
## 6                   0     1</code></pre>
<p>It seems natural to add an offset corresponding to the total count per night, so a 15th column with a <span class="math inline">\(49 \times 17\)</span> of offset. It corresponds to the matrix <span class="math inline">\(\mathbf{O}\)</span> in our model:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">trichoptera<span class="op">$</span>TotalCount &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/matrix">matrix</a></span>(</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colSums">rowSums</a></span>(trichoptera<span class="op">$</span>Abundance),</a>
<a class="sourceLine" id="cb8-3" data-line-number="3">  <span class="dt">nrow =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(trichoptera<span class="op">$</span>Abundance),</a>
<a class="sourceLine" id="cb8-4" data-line-number="4">  <span class="dt">ncol =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">ncol</a></span>(trichoptera<span class="op">$</span>Abundance)</a>
<a class="sourceLine" id="cb8-5" data-line-number="5">)</a></code></pre></div>
</div>
<div id="a-model-with-latent-main-effects-for-the-trichopetra-data-set" class="section level3">
<h3 class="hasAnchor">
<a href="#a-model-with-latent-main-effects-for-the-trichopetra-data-set" class="anchor"></a>A model with latent main effects for the Trichopetra data set</h3>
<p>The model can be fitted with the function <code>PLN</code> as follows:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">myPLN &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PLN.html">PLN</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/offset">offset</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log</a></span>(TotalCount)), trichoptera)</a></code></pre></div>
<pre><code>## 
##  Initialization...
##  Adjusting a PLN model with full covariance model
##  Post-treatments...
##  DONE!</code></pre>
<p>Note the use of the <code>formula</code> object to specify the model: the vector <span class="math inline">\(\boldsymbol\mu\)</span> of main effects in the mathematical formulation (one per column species) is specified in the call with the formula <code>~ 1</code>. We use the function offset with a log transform of the total count. Abundace is a variable in ther data frame <code>trichoptera</code> correspondings to a matrix of 17 columns.</p>
<p><code>myPLN</code> is an <code>R6</code> object with class <code>PLNfit</code>, which comes with a couple of methods, as recalled when printing such an object:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">myPLN</a></code></pre></div>
<pre><code>## A multivariate Poisson Lognormal fit with  covariance model.
## ==================================================================
##  degrees_freedom   loglik       BIC       ICL R_squared
##              170 -1051.51 -1382.315 -2206.456 0.9221898
## ==================================================================
## * Useful fields 
##     $model_par, $fitted, $latent, $var_par, $optim_par 
##     $loglik, $BIC, $ICL, $loglik_vec, $degrees_freedom, $criteria 
## * Useful S3 methods
##     plot(), print(), vcov(), coef(), predict()</code></pre>
<p>Let us try tto access the most common fields:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">myPLN<span class="op">$</span>loglik</a></code></pre></div>
<pre><code>## [1] -1051.51</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1">myPLN<span class="op">$</span>BIC</a></code></pre></div>
<pre><code>## [1] -1382.315</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">myPLN<span class="op">$</span>ICL</a></code></pre></div>
<pre><code>## [1] -2206.456</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">myPLN<span class="op">$</span>R_squared</a></code></pre></div>
<pre><code>## [1] 0.9221898</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">myPLN<span class="op">$</span>criteria</a></code></pre></div>
<pre><code>## degrees_freedom          loglik             BIC             ICL 
##     170.0000000   -1051.5101453   -1382.3148706   -2206.4559594 
##       R_squared 
##       0.9221898</code></pre>
<p>We can also reach the matrix of regression parameters and the variance/covariance matrix of the latent variable <span class="math inline">\(Z\)</span> with the traditional function found in <code>R</code> for (g)lm manipulation:</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(myPLN)</a></code></pre></div>
<pre><code>##     (Intercept)
## Che  -8.1758298
## Hyc  -8.2744787
## Hym  -2.9772947
## Hys  -7.0796789
## Psy  -0.5474232
## Aga  -4.0847848
## Glo  -6.3332059
## Ath  -6.0417848
## Cea  -7.0924433
## Ced  -3.6343301
## Set  -4.3880313
## All  -4.9228238
## Han  -4.8069707
## Hfo  -6.1345729
## Hsp  -4.2286895
## Hve  -6.8486334
## Sta  -2.8816336</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/vcov">vcov</a></span>(myPLN)</a></code></pre></div>
<pre><code>##              Che          Hyc         Hym         Hys           Psy
## Che  2.529411630 -0.009215819  0.36082477  0.44564597 -0.0178282595
## Hyc -0.009215819  1.904770704  0.11224047  0.27139847 -0.1466087361
## Hym  0.360824767  0.112240470  1.24444626  0.86555132 -0.1190491736
## Hys  0.445645970  0.271398472  0.86555132  2.66302451 -0.1472581274
## Psy -0.017828260 -0.146608736 -0.11904917 -0.14725813  0.0764001855
## Aga  0.309176363 -0.132056606  0.51328185  0.42494717  0.0014605705
## Glo  0.089670071  0.172137449  0.21093572  0.34358064 -0.0503402050
## Ath  0.352976131  0.110706588  0.38565793  0.60814441 -0.0482930974
## Cea -0.009624458  0.006142729 -0.02209937 -0.01638584  0.0001489324
## Ced  0.338558034  0.222119074  0.50858370  0.68180081 -0.0985171424
## Set -0.057574453  0.475195973 -0.17746749  0.14137099 -0.0915935062
## All  0.272225949 -0.262949138  0.68010438  0.36899497 -0.0047823894
## Han -0.183240911  0.623213293  0.21121839  0.13703482 -0.2886269820
## Hfo -0.364800658  0.561977242 -0.39272387 -0.18100072 -0.1467596753
## Hsp -0.445699361  0.674240587 -0.33323567 -0.17586225 -0.1926012502
## Hve  0.313161624 -0.131436859  0.16073332  0.24125481  0.0457374778
## Sta  0.364489993  0.256032663  0.47851948  0.61426875 -0.1214551581
##              Aga          Glo          Ath           Cea          Ced
## Che  0.309176363  0.089670071  0.352976131 -0.0096244584  0.338558034
## Hyc -0.132056606  0.172137449  0.110706588  0.0061427294  0.222119074
## Hym  0.513281846  0.210935722  0.385657929 -0.0220993692  0.508583696
## Hys  0.424947172  0.343580640  0.608144412 -0.0163858378  0.681800806
## Psy  0.001460571 -0.050340205 -0.048293097  0.0001489324 -0.098517142
## Aga  1.101594941 -0.063483987  0.197065711 -0.0232824207  0.218776110
## Glo -0.063483987  1.113811336  0.225062631  0.0018878920  0.227062585
## Ath  0.197065711  0.225062631  1.374722030 -0.0067466737  0.443376400
## Cea -0.023282421  0.001887892 -0.006746674  0.0475059956 -0.007498858
## Ced  0.218776110  0.227062585  0.443376400 -0.0074988575  0.958484517
## Set -0.299921632  0.292154814  0.098619899  0.0161235754  0.195371240
## All  0.593052437 -0.076603635  0.087669451 -0.0260857161  0.080335764
## Han -0.171542408 -0.186142246 -0.196205747  0.0050069979  0.056605972
## Hfo -0.814611134  0.302616339 -0.157146685  0.0285290479 -0.130671140
## Hsp -0.780733088  0.253449039 -0.217411781  0.0264870038 -0.112952725
## Hve  0.186473703  0.088258307  0.242193024 -0.0072900029  0.204530834
## Sta  0.439870981  0.017646766  0.308787352 -0.0139134383  0.434538489
##             Set          All          Han         Hfo        Hsp
## Che -0.05757445  0.272225949 -0.183240911 -0.36480066 -0.4456994
## Hyc  0.47519597 -0.262949138  0.623213293  0.56197724  0.6742406
## Hym -0.17746749  0.680104380  0.211218390 -0.39272387 -0.3332357
## Hys  0.14137099  0.368994973  0.137034819 -0.18100072 -0.1758623
## Psy -0.09159351 -0.004782389 -0.288626982 -0.14675968 -0.1926013
## Aga -0.29992163  0.593052437 -0.171542408 -0.81461113 -0.7807331
## Glo  0.29215481 -0.076603635 -0.186142246  0.30261634  0.2534490
## Ath  0.09861990  0.087669451 -0.196205747 -0.15714668 -0.2174118
## Cea  0.01612358 -0.026085716  0.005006998  0.02852905  0.0264870
## Ced  0.19537124  0.080335764  0.056605972 -0.13067114 -0.1129527
## Set  1.56524033 -0.677262727 -0.040632700  0.80829510  0.7651370
## All -0.67726273  1.807872407  0.030828035 -0.74216023 -0.6585103
## Han -0.04063270  0.030828035  3.636091145  0.61918590  0.9860471
## Hfo  0.80829510 -0.742160234  0.619185903  2.75004151  1.6346201
## Hsp  0.76513697 -0.658510338  0.986047100  1.63462014  2.5162726
## Hve -0.03982150  0.146306388 -0.599578122 -0.34312314 -0.4825035
## Sta  0.05555983  0.200092557  0.463296766 -0.25664106 -0.1935130
##              Hve         Sta
## Che  0.313161624  0.36448999
## Hyc -0.131436859  0.25603266
## Hym  0.160733325  0.47851948
## Hys  0.241254808  0.61426875
## Psy  0.045737478 -0.12145516
## Aga  0.186473703  0.43987098
## Glo  0.088258307  0.01764677
## Ath  0.242193024  0.30878735
## Cea -0.007290003 -0.01391344
## Ced  0.204530834  0.43453849
## Set -0.039821502  0.05555983
## All  0.146306388  0.20009256
## Han -0.599578122  0.46329677
## Hfo -0.343123138 -0.25664106
## Hsp -0.482503456 -0.19351299
## Hve  1.350926852  0.14369567
## Sta  0.143695667  1.02889984</code></pre>
<p>One can have a glance to these quantities with the <code>plot</code> method: Complementary information comes with the <code>plot</code> method:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(myPLN)</a></code></pre></div>
<p><img src="PLN_trichoptera_files/figure-html/plot_model-1.png" width="672"></p>
<p>You can also check the variational parameter if you need (and understand what they represent):</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(myPLN, <span class="st">"variational"</span>)</a></code></pre></div>
<p><img src="PLN_trichoptera_files/figure-html/plot_var-1.png" width="672"></p>
<p>It is also possible to use observation weights like in standard (generalized) linear models:</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1">myPLN_weighted &lt;-<span class="st"> </span><span class="kw"><a href="../reference/PLN.html">PLN</a></span>(Abundance <span class="op">~</span><span class="st"> </span><span class="dv">1</span> <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/offset">offset</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log</a></span>(TotalCount)), <span class="dt">data =</span> trichoptera, <span class="dt">weights =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/Uniform">runif</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/nrow">nrow</a></span>(trichoptera)))</a></code></pre></div>
<pre><code>## 
##  Initialization...
##  Adjusting a PLN model with full covariance model (with observation weigths)
##  Post-treatments...
##  DONE!</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(myPLN_weighted, <span class="st">"model"</span>)</a></code></pre></div>
<p><img src="PLN_trichoptera_files/figure-html/weighted-1.png" width="672"></p>
<p>The prediction method can be use to predict new responses from a new table of data (with both covariates and offset if needed.)</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(myPLN, <span class="dt">newdata =</span> trichoptera[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ], <span class="dt">type =</span> <span class="st">"response"</span>)</a></code></pre></div>
<pre><code>##            Che         Hyc        Hym        Hys        Psy       Aga
## 1  0.028902473 0.019162548  2.7517148 0.09247002  17.427906 0.8464607
## 2  0.012956281 0.008590108  1.2335273 0.04145208   7.812510 0.3794479
## 3  0.037872205 0.025109546  3.6056952 0.12116761  22.836566 1.1091554
## 4  0.191354301 0.126869284 18.2182495 0.61221530 115.384757 5.6041534
## 5  0.078734322 0.052201424  7.4960506 0.25190109  47.476020 2.3058756
## 6  0.017939466 0.011893995  1.7079609 0.05739518  10.817321 0.5253894
## 7  0.007973096 0.005286220  0.7590937 0.02550897   4.807698 0.2335064
## 8  0.033885658 0.022466436  3.2261484 0.10841313  20.432717 0.9924022
## 9  0.011959644 0.007929330  1.1386406 0.03826346   7.211547 0.3502596
## 10 0.003986548 0.002643110  0.3795469 0.01275449   2.403849 0.1167532
##           Glo        Ath         Cea       Ced       Set        All
## 1  0.08990476 0.13708859 0.024689075 1.2364050 0.7881118 0.52121546
## 2  0.04030213 0.06145351 0.011067517 0.5542505 0.3532915 0.23364831
## 3  0.11780624 0.17963332 0.032351202 1.6201169 1.0326982 0.68297198
## 4  0.59523152 0.90762100 0.163458706 8.1858537 5.2178436 3.45080582
## 5  0.24491297 0.37344822 0.067256447 3.3681377 2.1469252 1.41986281
## 6  0.05580295 0.08508947 0.015324254 0.7674238 0.4891728 0.32351305
## 7  0.02480131 0.03781754 0.006810779 0.3410772 0.2174102 0.14378358
## 8  0.10540558 0.16072455 0.028945813 1.4495783 0.9239931 0.61108020
## 9  0.03720197 0.05672631 0.010216169 0.5116159 0.3261152 0.21567536
## 10 0.01240066 0.01890877 0.003405390 0.1705386 0.1087051 0.07189179
##          Han        Hfo       Hsp        Hve        Sta
## 1  1.4599041 0.24851394 1.4869731 0.06045391  2.7185867
## 2  0.6544398 0.11140280 0.6665742 0.02710003  1.2186768
## 3  1.9129778 0.32563896 1.9484475 0.07921546  3.5622860
## 4  9.6655720 1.64533367 9.8447876 0.40024655 17.9989186
## 5  3.9769801 0.67698625 4.0507199 0.16468478  7.4058050
## 6  0.9061474 0.15425003 0.9229488 0.03752311  1.6873986
## 7  0.4027322 0.06855557 0.4101995 0.01667694  0.7499549
## 8  1.7116117 0.29136117 1.7433478 0.07087699  3.1873085
## 9  0.6040982 0.10283335 0.6152992 0.02501541  1.1249324
## 10 0.2013661 0.03427778 0.2050997 0.00833847  0.3749775
## attr(,"type")
## [1] "response"</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#mathematical-background">Mathematical background</a></li>
      <li><a href="#analysis-of-the-trichoptera-data-set">Analysis of the Trichoptera data set</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Julien Chiquet, Mahendra Mariadassou.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.2.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
